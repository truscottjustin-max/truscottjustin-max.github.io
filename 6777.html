<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Screen Calculator (Always Type)</title>
    
    <!-- Embedded CSS Styles -->
    <style>
        /* HTML and Body should fill the whole viewport */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden; /* Hide main body scrollbar if calculator fills screen */
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f4f4f4;
            font-family: Arial, sans-serif;
            transition: box-shadow 0.3s ease; 
        }

        .calculator {
            background-color: #fff;
            padding: 2vh; /* Use viewport units for padding */
            border-radius: 10px;
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.19);
            width: 90vw; /* Fit 90% of viewport width */
            height: 90vh; /* Fit 90% of viewport height */
            display: flex;
            flex-direction: column; /* Stack display and buttons vertically */
        }

        #display {
            width: 100%;
            padding: 10px;
            font-size: 2em;
            text-align: right;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 2vh;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease-in-out;
            flex-grow: 0;
        }
        
        #display.faded { opacity: 0; }

        body.is-typing #display {
            border-color: #007bff; 
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); 
        }

        .top-row {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 1vh;
            margin-bottom: 1vh;
        }

        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1vh;
            flex-grow: 1; /* Allows button grid to fill remaining vertical space */
        }
        
        button {
            padding: 15px;
            font-size: 1.2em;
            border: none;
            border-radius: 5px;
            background-color: #e0e0e0;
            cursor: pointer;
            transition: background-color 0.2s;
            height: 100%; 
            box-sizing: border-box;
        }

        button:hover { background-color: #d4d4d4; }
        .operator { background-color: #ff9800; color: white; }
        .operator:hover { background-color: #e68900; }
        .clear-btn { background-color: #e53935; color: white; grid-row: span 2; height: 100%; }
        .clear-btn:hover { background-color: #c62828; }
        .span-four { grid-column: span 4; }

        #resultArea { display: none !important; }
    </style>
</head>
<body>
    <div class="calculator">
        <input type="text" id="display" disabled>
        
        <div class="top-row">
            <div class="utility-buttons">
                <button class="operator" data-char="(">(</button>
                <button class="operator" data-char=")">)</button>
                <button class="operator" data-action="delete">&larr;</button>
            </div>
            <button class="clear-btn" data-action="clear">C</button>
        </div>

        <div class="buttons">
            <button data-char="7">7</button><button data-char="8">8</button><button data-char="9">9</button>
            <button class="operator" data-char="/" data-action="divide">/</button>
            <button data-char="4">4</button><button data-char="5">5</button><button data-char="6">6</button>
            <button class="operator" data-char="*" data-action="multiply">*</button>
            <button data-char="1">1</button><button data-char="2">2</button><button data-char="3">3</button>
            <button class="operator" data-char="-" data-action="subtract">-</button>
            <button data-char="." data-action="decimal">.</button><button data-char="0">0</button>
            <button class="operator" data-char="%" data-action="percentage">%</button>
            <button class="operator" data-char="+" data-action="add">+</button>
            <button id="equalsButton" class="span-four operator" data-action="calculate">=</button>
        </div>
    </div>
    
    <div id="resultArea">
        <strong>Answer:</strong> <span id="answer"></span>
    </div>

    <!-- JavaScript Logic -->
    <script>
        const display = document.getElementById('display');
        const calculator = document.querySelector('.calculator');
        const equalsButton = document.getElementById('equalsButton'); 
        const body = document.body;
        
        const kbDisplay = document.getElementById("display"); 
        const baseEquation = "(100/2)+17"; 
        const equationAnswer = 67; 
        let charIndex = 0;
        let currentSegment = "";
        let segmentIndex = 0;

        function resetTypingScript() { charIndex = 0; currentSegment = ""; segmentIndex = 0; }

        // --- 1. Calculator Button Logic ---
        calculator.addEventListener('click', (event) => {
            if (!event.target.closest('button')) return;
            const button = event.target;
            const action = button.dataset.action;
            if (action === 'clear') { display.value = ''; resetTypingScript(); } 
            else if (action === 'delete') { display.value = display.value.slice(0, -1); } 
            else if (action === 'calculate') {
                try {
                    display.classList.add('faded');
                    setTimeout(() => {
                        let result = eval(display.value.replace('%', '/100*')); 
                        if (result === undefined || display.value.trim() === '') { result = equationAnswer; }
                        display.value = result;
                        resetTypingScript();
                        display.classList.remove('faded');
                        kbDisplay.scrollLeft = kbDisplay.scrollWidth;
                    }, 300); 
                } catch { display.value = 'Error'; display.classList.remove('faded'); }
            } else { display.value += button.textContent; }
        });

        // --- 2. Keyboard Auto-Typing Script Logic ---

        function generateRandomZeroSegment() {
           const useMultiplication = Math.random() < 0.5;
            const flipOrder = Math.random() < 0.5;
            let X, Y, Z;
            X = Math.floor(Math.random() * 9) + 2; Y = Math.floor(Math.random() * 9) + 2; 
            if (useMultiplication) { Z = X * Y; return flipOrder ? `+((${Z})-(${X}*${Y}))` : `+((${X}*${Y})-(${Z}))`; } 
            else { Z = Math.floor(Math.random() * 9) + 2; X = Y * Z; return flipOrder ? `+((${Z})-(${X}/${Y}))` : `+((${X}/${Y})-(${Z}))`; }
        }

        const handleKeyDown = function(event) {
            if (!kbDisplay.value.startsWith(baseEquation.substring(0, charIndex))) {
                resetTypingScript();
            }

            if (event.key.length === 1 && !event.ctrlKey && !event.metaKey) {
                 event.preventDefault(); 
                 
                if (charIndex < baseEquation.length) {
                    kbDisplay.value += baseEquation[charIndex];
                    charIndex += 1;
                } else {
                    if (currentSegment === "") {
                        currentSegment = generateRandomZeroSegment();
                        segmentIndex = 0;
                    }
                    
                    // The following logic forces character-by-character typing always
                    if (segmentIndex < currentSegment.length) { 
                        kbDisplay.value += currentSegment[segmentIndex]; 
                        segmentIndex += 1; 
                    }

                    if (segmentIndex === currentSegment.length) {
                        currentSegment = "";
                        segmentIndex = 0;
                    }
                }
                kbDisplay.scrollLeft = kbDisplay.scrollWidth; 
            } else if (event.key === "Enter") {
                equalsButton.click(); 
            } else if (event.key === "Backspace") {
                return; 
            }
        };

        document.addEventListener("keydown", handleKeyDown);
        body.classList.add('is-typing'); 
    </script>
</body>
</html>